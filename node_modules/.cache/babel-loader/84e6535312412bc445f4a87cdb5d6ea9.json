{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}(); // Internal Imports\n\n\nimport { Service } from '../service';\nimport { Events, Alignments } from './../../interfaces'; // D3 Imports\n\nimport { select } from 'd3-selection';\nimport { Tools } from '../../tools'; // import the settings for the css prefix\n\nimport settings from 'carbon-components/es/globals/js/settings'; // MISC\n\nimport ResizeObserver from 'resize-observer-polyfill';\nvar CSS_VERIFIER_ELEMENT_CLASSNAME = 'DONT_STYLE_ME_css_styles_verifier';\n\nvar DOMUtils =\n/** @class */\nfunction (_super) {\n  __extends(DOMUtils, _super);\n\n  function DOMUtils() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  DOMUtils.getSVGElementSize = function (svgSelector, options) {\n    if (!svgSelector.attr) {\n      svgSelector = select(svgSelector);\n    }\n\n    var finalDimensions = {\n      width: 0,\n      height: 0\n    };\n\n    var validateAndSetDimensions = function validateAndSetDimensions(dimensions) {\n      if (dimensions) {\n        Object.keys(finalDimensions).forEach(function (dimensionKey) {\n          if (dimensions[dimensionKey]) {\n            var dimension = dimensions[dimensionKey];\n            var dimensionNumber = parseFloat(dimension);\n\n            if (dimension && dimensionNumber > finalDimensions[dimensionKey] && ('' + dimension).indexOf('%') === -1) {\n              finalDimensions[dimensionKey] = dimensionNumber;\n            }\n          }\n        });\n      }\n    };\n\n    var attrDimensions = {\n      width: svgSelector.attr('width'),\n      height: svgSelector.attr('height')\n    };\n    var bbox, bboxDimensions, boundingRect, boundingRectDimensions; // In many versions of Firefox\n    // getBBox will cause an \"NSFailure\" error\n\n    try {\n      bbox = svgSelector.node().getBBox();\n      bboxDimensions = {\n        width: bbox.width,\n        height: bbox.height\n      };\n    } catch (e) {}\n\n    try {\n      boundingRect = svgSelector.node().getBoundingClientRect();\n      boundingRectDimensions = {\n        width: boundingRect.width,\n        height: boundingRect.height\n      };\n    } catch (e) {}\n\n    var clientDimensions = {\n      width: svgSelector.node().clientWidth,\n      height: svgSelector.node().clientHeight\n    }; // If both attribute values are numbers\n    // And not percentages or NaN\n\n    if (options) {\n      if (options.useAttrs) {\n        validateAndSetDimensions(attrDimensions);\n\n        if (finalDimensions.width > 0 && finalDimensions.height > 0) {\n          return finalDimensions;\n        }\n      }\n\n      if (options.useClientDimensions) {\n        validateAndSetDimensions(clientDimensions);\n\n        if (finalDimensions.width > 0 && finalDimensions.height > 0) {\n          return clientDimensions;\n        }\n      }\n\n      if (options.useBBox) {\n        validateAndSetDimensions(bboxDimensions);\n\n        if (finalDimensions.width > 0 && finalDimensions.height > 0) {\n          return bboxDimensions;\n        }\n      }\n\n      if (options.useBoundingRect) {\n        validateAndSetDimensions(boundingRectDimensions);\n\n        if (finalDimensions.width > 0 && finalDimensions.height > 0) {\n          return boundingRectDimensions;\n        }\n      }\n    }\n\n    try {\n      var nativeDimensions = {\n        width: Tools.getProperty(svgSelector.node(), 'width', 'baseVal', 'value'),\n        height: Tools.getProperty(svgSelector.node(), 'height', 'baseVal', 'value')\n      };\n      validateAndSetDimensions(nativeDimensions);\n    } catch (e) {\n      validateAndSetDimensions(clientDimensions);\n      validateAndSetDimensions(bboxDimensions);\n      validateAndSetDimensions(attrDimensions);\n    }\n\n    return finalDimensions;\n  };\n\n  DOMUtils.appendOrSelect = function (parent, query) {\n    var selection = parent.select(\"\" + query);\n\n    if (selection.empty()) {\n      // see if there is an id\n      var querySections = query.split('#');\n      var elementToAppend = void 0;\n      var id = void 0; // if there is an id\n\n      if (querySections.length === 2) {\n        // take out the element to append\n        elementToAppend = querySections[0]; // split it by classes\n\n        querySections = querySections[1].split('.'); // the first string is the id\n\n        id = querySections[0];\n      } else {\n        querySections = query.split('.');\n        elementToAppend = querySections[0];\n      }\n\n      return parent.append(elementToAppend).attr('id', id).attr('class', querySections.slice(1).join(' '));\n    }\n\n    return selection;\n  };\n\n  DOMUtils.getAlignmentOffset = function (alignment, svg, parent) {\n    var svgDimensions = DOMUtils.getSVGElementSize(svg, {\n      useBBox: true\n    });\n    var width = DOMUtils.getSVGElementSize(parent, {\n      useAttr: true\n    }).width;\n    var alignmentOffset = 0;\n\n    if (alignment === Alignments.CENTER) {\n      alignmentOffset = Math.floor((width - svgDimensions.width) / 2);\n    } else if (alignment === Alignments.RIGHT) {\n      alignmentOffset = width - svgDimensions.width;\n    }\n\n    return alignmentOffset;\n  };\n\n  DOMUtils.prototype.init = function () {\n    // Add width & height to the chart holder if necessary, and add a classname\n    this.styleHolderElement(); // Add main SVG\n\n    this.addSVGElement();\n    this.verifyCSSStylesBeingApplied();\n\n    if (this.model.getOptions().resizable) {\n      this.addResizeListener();\n    }\n\n    this.addHolderListeners();\n  };\n\n  DOMUtils.prototype.update = function () {\n    this.styleHolderElement();\n  };\n\n  DOMUtils.prototype.styleHolderElement = function () {\n    var holderElement = this.getHolder(); // Add class to chart holder\n\n    select(this.getHolder()).classed(settings.prefix + \"--chart-holder\", true); // In order for resize events to not clash with these updates\n    // We'll check if the width & height values passed in options\n    // Have changed, before setting them to the holder\n\n    var _a = this.model.getOptions(),\n        width = _a.width,\n        height = _a.height;\n\n    if (width !== this.width) {\n      // Apply formatted width attribute to chart\n      holderElement.style.width = width;\n      this.width = width;\n    }\n\n    if (height !== this.height) {\n      // Apply formatted width attribute to chart\n      holderElement.style.height = height;\n      this.height = height;\n    }\n  };\n\n  DOMUtils.prototype.getHolder = function () {\n    return this.model.get('holder');\n  };\n\n  DOMUtils.prototype.addSVGElement = function () {\n    var options = this.model.getOptions();\n    var chartsprefix = Tools.getProperty(options, 'style', 'prefix');\n    var svg = select(this.getHolder()).append('svg').classed(settings.prefix + \"--\" + chartsprefix + \"--chart-svg\", true).attr('height', '100%').attr('width', '100%');\n    svg.append('g').attr('class', CSS_VERIFIER_ELEMENT_CLASSNAME);\n    this.svg = svg.node();\n  };\n\n  DOMUtils.prototype.verifyCSSStylesBeingApplied = function () {\n    var _this = this; // setTimeout is needed here since in `addSVGElement()` we're appending the\n    // CSS verifier element, and need to allow some time for it to become available\n    // in the DOM\n\n\n    setTimeout(function () {\n      var cssVerifierElement = select(_this.svg).select(\"g.\" + CSS_VERIFIER_ELEMENT_CLASSNAME).node();\n      var computedStyles = getComputedStyle(cssVerifierElement);\n\n      if (computedStyles.getPropertyValue('overflow') !== 'hidden' || computedStyles.getPropertyValue('opacity') !== '0') {\n        console.error('Missing CSS styles for Carbon Charts. Please read the Carbon Charts getting started guide.');\n      }\n    });\n  };\n\n  DOMUtils.prototype.setSVGMaxHeight = function () {\n    // if there is a set height on the holder, leave the chart svg height at 100%\n    if (!this.model.getOptions().height) {\n      var chartHeight = DOMUtils.getSVGElementSize(select(this.svg), {\n        useBBox: true\n      }).height;\n      var chartSVGSelector = select(this.svg).attr('class');\n      var children = select(this.svg).selectAll(\".\" + chartSVGSelector + \" > svg\"); // get the height of the children SVGs (spacers, titles, etc)\n\n      var childrenHeight_1 = 0;\n      children.nodes().forEach(function (childSVG) {\n        childrenHeight_1 += Number(DOMUtils.getSVGElementSize(select(childSVG), {\n          useBBox: true\n        }).height);\n      }); // set the chart svg height to the children height\n      // forcing the chart not to take up any more space than it requires\n\n      childrenHeight_1 <= chartHeight ? select(this.svg).attr('height', childrenHeight_1) : select(this.svg).attr('height', '100%');\n    }\n  };\n\n  DOMUtils.prototype.getMainSVG = function () {\n    return this.svg;\n  };\n\n  DOMUtils.prototype.addHolderListeners = function () {\n    var _this = this;\n\n    var holder = this.getHolder();\n\n    if (!holder) {\n      return;\n    }\n\n    select(holder).on('mouseover', function () {\n      // Dispatch event\n      _this.services.events.dispatchEvent(Events.Chart.MOUSEOVER);\n    }).on('mouseout', function () {\n      // Dispatch event\n      _this.services.events.dispatchEvent(Events.Chart.MOUSEOUT);\n    });\n  };\n\n  DOMUtils.prototype.addResizeListener = function () {\n    var _this = this;\n\n    var holder = this.getHolder();\n\n    if (!holder) {\n      return;\n    } // Grab current dimensions of the chart holder\n\n\n    var containerWidth = holder.clientWidth;\n    var containerHeight = holder.clientHeight; // The resize callback function\n\n    var resizeCallback = Tools.debounce(function (entries, observer) {\n      if (!holder) {\n        return;\n      }\n\n      if (Math.abs(containerWidth - holder.clientWidth) > 1 || Math.abs(containerHeight - holder.clientHeight) > 1) {\n        containerWidth = holder.clientWidth;\n        containerHeight = holder.clientHeight;\n\n        _this.services.events.dispatchEvent(Events.Chart.RESIZE);\n      }\n    }, 12.5); // Observe the behaviour of resizing on the holder\n\n    var resizeObserver = new ResizeObserver(resizeCallback);\n    resizeObserver.observe(holder);\n  };\n\n  return DOMUtils;\n}(Service);\n\nexport { DOMUtils };","map":{"version":3,"sources":["/Users/zander/Documents/Development/ActionsLogging/Dashboard/node_modules/@carbon/charts/services/essentials/dom-utils.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","Service","Events","Alignments","select","Tools","settings","ResizeObserver","CSS_VERIFIER_ELEMENT_CLASSNAME","DOMUtils","_super","apply","arguments","getSVGElementSize","svgSelector","options","attr","finalDimensions","width","height","validateAndSetDimensions","dimensions","keys","forEach","dimensionKey","dimension","dimensionNumber","parseFloat","indexOf","attrDimensions","bbox","bboxDimensions","boundingRect","boundingRectDimensions","node","getBBox","e","getBoundingClientRect","clientDimensions","clientWidth","clientHeight","useAttrs","useClientDimensions","useBBox","useBoundingRect","nativeDimensions","getProperty","appendOrSelect","parent","query","selection","empty","querySections","split","elementToAppend","id","length","append","slice","join","getAlignmentOffset","alignment","svg","svgDimensions","useAttr","alignmentOffset","CENTER","Math","floor","RIGHT","init","styleHolderElement","addSVGElement","verifyCSSStylesBeingApplied","model","getOptions","resizable","addResizeListener","addHolderListeners","update","holderElement","getHolder","classed","prefix","_a","style","get","chartsprefix","_this","setTimeout","cssVerifierElement","computedStyles","getComputedStyle","getPropertyValue","console","error","setSVGMaxHeight","chartHeight","chartSVGSelector","children","selectAll","childrenHeight_1","nodes","childSVG","Number","getMainSVG","holder","on","services","events","dispatchEvent","Chart","MOUSEOVER","MOUSEOUT","containerWidth","containerHeight","resizeCallback","debounce","entries","observer","abs","RESIZE","resizeObserver","observe"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n// Internal Imports\nimport { Service } from '../service';\nimport { Events, Alignments } from './../../interfaces';\n// D3 Imports\nimport { select } from 'd3-selection';\nimport { Tools } from '../../tools';\n// import the settings for the css prefix\nimport settings from 'carbon-components/es/globals/js/settings';\n// MISC\nimport ResizeObserver from 'resize-observer-polyfill';\nvar CSS_VERIFIER_ELEMENT_CLASSNAME = 'DONT_STYLE_ME_css_styles_verifier';\nvar DOMUtils = /** @class */ (function (_super) {\n    __extends(DOMUtils, _super);\n    function DOMUtils() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DOMUtils.getSVGElementSize = function (svgSelector, options) {\n        if (!svgSelector.attr) {\n            svgSelector = select(svgSelector);\n        }\n        var finalDimensions = {\n            width: 0,\n            height: 0,\n        };\n        var validateAndSetDimensions = function (dimensions) {\n            if (dimensions) {\n                Object.keys(finalDimensions).forEach(function (dimensionKey) {\n                    if (dimensions[dimensionKey]) {\n                        var dimension = dimensions[dimensionKey];\n                        var dimensionNumber = parseFloat(dimension);\n                        if (dimension &&\n                            dimensionNumber > finalDimensions[dimensionKey] &&\n                            ('' + dimension).indexOf('%') === -1) {\n                            finalDimensions[dimensionKey] = dimensionNumber;\n                        }\n                    }\n                });\n            }\n        };\n        var attrDimensions = {\n            width: svgSelector.attr('width'),\n            height: svgSelector.attr('height'),\n        };\n        var bbox, bboxDimensions, boundingRect, boundingRectDimensions;\n        // In many versions of Firefox\n        // getBBox will cause an \"NSFailure\" error\n        try {\n            bbox = svgSelector.node().getBBox();\n            bboxDimensions = {\n                width: bbox.width,\n                height: bbox.height,\n            };\n        }\n        catch (e) { }\n        try {\n            boundingRect = svgSelector.node().getBoundingClientRect();\n            boundingRectDimensions = {\n                width: boundingRect.width,\n                height: boundingRect.height,\n            };\n        }\n        catch (e) { }\n        var clientDimensions = {\n            width: svgSelector.node().clientWidth,\n            height: svgSelector.node().clientHeight,\n        };\n        // If both attribute values are numbers\n        // And not percentages or NaN\n        if (options) {\n            if (options.useAttrs) {\n                validateAndSetDimensions(attrDimensions);\n                if (finalDimensions.width > 0 && finalDimensions.height > 0) {\n                    return finalDimensions;\n                }\n            }\n            if (options.useClientDimensions) {\n                validateAndSetDimensions(clientDimensions);\n                if (finalDimensions.width > 0 && finalDimensions.height > 0) {\n                    return clientDimensions;\n                }\n            }\n            if (options.useBBox) {\n                validateAndSetDimensions(bboxDimensions);\n                if (finalDimensions.width > 0 && finalDimensions.height > 0) {\n                    return bboxDimensions;\n                }\n            }\n            if (options.useBoundingRect) {\n                validateAndSetDimensions(boundingRectDimensions);\n                if (finalDimensions.width > 0 && finalDimensions.height > 0) {\n                    return boundingRectDimensions;\n                }\n            }\n        }\n        try {\n            var nativeDimensions = {\n                width: Tools.getProperty(svgSelector.node(), 'width', 'baseVal', 'value'),\n                height: Tools.getProperty(svgSelector.node(), 'height', 'baseVal', 'value'),\n            };\n            validateAndSetDimensions(nativeDimensions);\n        }\n        catch (e) {\n            validateAndSetDimensions(clientDimensions);\n            validateAndSetDimensions(bboxDimensions);\n            validateAndSetDimensions(attrDimensions);\n        }\n        return finalDimensions;\n    };\n    DOMUtils.appendOrSelect = function (parent, query) {\n        var selection = parent.select(\"\" + query);\n        if (selection.empty()) {\n            // see if there is an id\n            var querySections = query.split('#');\n            var elementToAppend = void 0;\n            var id = void 0;\n            // if there is an id\n            if (querySections.length === 2) {\n                // take out the element to append\n                elementToAppend = querySections[0];\n                // split it by classes\n                querySections = querySections[1].split('.');\n                // the first string is the id\n                id = querySections[0];\n            }\n            else {\n                querySections = query.split('.');\n                elementToAppend = querySections[0];\n            }\n            return parent\n                .append(elementToAppend)\n                .attr('id', id)\n                .attr('class', querySections.slice(1).join(' '));\n        }\n        return selection;\n    };\n    DOMUtils.getAlignmentOffset = function (alignment, svg, parent) {\n        var svgDimensions = DOMUtils.getSVGElementSize(svg, {\n            useBBox: true,\n        });\n        var width = DOMUtils.getSVGElementSize(parent, { useAttr: true }).width;\n        var alignmentOffset = 0;\n        if (alignment === Alignments.CENTER) {\n            alignmentOffset = Math.floor((width - svgDimensions.width) / 2);\n        }\n        else if (alignment === Alignments.RIGHT) {\n            alignmentOffset = width - svgDimensions.width;\n        }\n        return alignmentOffset;\n    };\n    DOMUtils.prototype.init = function () {\n        // Add width & height to the chart holder if necessary, and add a classname\n        this.styleHolderElement();\n        // Add main SVG\n        this.addSVGElement();\n        this.verifyCSSStylesBeingApplied();\n        if (this.model.getOptions().resizable) {\n            this.addResizeListener();\n        }\n        this.addHolderListeners();\n    };\n    DOMUtils.prototype.update = function () {\n        this.styleHolderElement();\n    };\n    DOMUtils.prototype.styleHolderElement = function () {\n        var holderElement = this.getHolder();\n        // Add class to chart holder\n        select(this.getHolder()).classed(settings.prefix + \"--chart-holder\", true);\n        // In order for resize events to not clash with these updates\n        // We'll check if the width & height values passed in options\n        // Have changed, before setting them to the holder\n        var _a = this.model.getOptions(), width = _a.width, height = _a.height;\n        if (width !== this.width) {\n            // Apply formatted width attribute to chart\n            holderElement.style.width = width;\n            this.width = width;\n        }\n        if (height !== this.height) {\n            // Apply formatted width attribute to chart\n            holderElement.style.height = height;\n            this.height = height;\n        }\n    };\n    DOMUtils.prototype.getHolder = function () {\n        return this.model.get('holder');\n    };\n    DOMUtils.prototype.addSVGElement = function () {\n        var options = this.model.getOptions();\n        var chartsprefix = Tools.getProperty(options, 'style', 'prefix');\n        var svg = select(this.getHolder())\n            .append('svg')\n            .classed(settings.prefix + \"--\" + chartsprefix + \"--chart-svg\", true)\n            .attr('height', '100%')\n            .attr('width', '100%');\n        svg.append('g').attr('class', CSS_VERIFIER_ELEMENT_CLASSNAME);\n        this.svg = svg.node();\n    };\n    DOMUtils.prototype.verifyCSSStylesBeingApplied = function () {\n        var _this = this;\n        // setTimeout is needed here since in `addSVGElement()` we're appending the\n        // CSS verifier element, and need to allow some time for it to become available\n        // in the DOM\n        setTimeout(function () {\n            var cssVerifierElement = select(_this.svg)\n                .select(\"g.\" + CSS_VERIFIER_ELEMENT_CLASSNAME)\n                .node();\n            var computedStyles = getComputedStyle(cssVerifierElement);\n            if (computedStyles.getPropertyValue('overflow') !== 'hidden' ||\n                computedStyles.getPropertyValue('opacity') !== '0') {\n                console.error('Missing CSS styles for Carbon Charts. Please read the Carbon Charts getting started guide.');\n            }\n        });\n    };\n    DOMUtils.prototype.setSVGMaxHeight = function () {\n        // if there is a set height on the holder, leave the chart svg height at 100%\n        if (!this.model.getOptions().height) {\n            var chartHeight = DOMUtils.getSVGElementSize(select(this.svg), { useBBox: true }).height;\n            var chartSVGSelector = select(this.svg).attr('class');\n            var children = select(this.svg).selectAll(\".\" + chartSVGSelector + \" > svg\");\n            // get the height of the children SVGs (spacers, titles, etc)\n            var childrenHeight_1 = 0;\n            children.nodes().forEach(function (childSVG) {\n                childrenHeight_1 += Number(DOMUtils.getSVGElementSize(select(childSVG), {\n                    useBBox: true,\n                }).height);\n            });\n            // set the chart svg height to the children height\n            // forcing the chart not to take up any more space than it requires\n            childrenHeight_1 <= chartHeight\n                ? select(this.svg).attr('height', childrenHeight_1)\n                : select(this.svg).attr('height', '100%');\n        }\n    };\n    DOMUtils.prototype.getMainSVG = function () {\n        return this.svg;\n    };\n    DOMUtils.prototype.addHolderListeners = function () {\n        var _this = this;\n        var holder = this.getHolder();\n        if (!holder) {\n            return;\n        }\n        select(holder)\n            .on('mouseover', function () {\n            // Dispatch event\n            _this.services.events.dispatchEvent(Events.Chart.MOUSEOVER);\n        })\n            .on('mouseout', function () {\n            // Dispatch event\n            _this.services.events.dispatchEvent(Events.Chart.MOUSEOUT);\n        });\n    };\n    DOMUtils.prototype.addResizeListener = function () {\n        var _this = this;\n        var holder = this.getHolder();\n        if (!holder) {\n            return;\n        }\n        // Grab current dimensions of the chart holder\n        var containerWidth = holder.clientWidth;\n        var containerHeight = holder.clientHeight;\n        // The resize callback function\n        var resizeCallback = Tools.debounce(function (entries, observer) {\n            if (!holder) {\n                return;\n            }\n            if (Math.abs(containerWidth - holder.clientWidth) > 1 ||\n                Math.abs(containerHeight - holder.clientHeight) > 1) {\n                containerWidth = holder.clientWidth;\n                containerHeight = holder.clientHeight;\n                _this.services.events.dispatchEvent(Events.Chart.RESIZE);\n            }\n        }, 12.5);\n        // Observe the behaviour of resizing on the holder\n        var resizeObserver = new ResizeObserver(resizeCallback);\n        resizeObserver.observe(holder);\n    };\n    return DOMUtils;\n}(Service));\nexport { DOMUtils };\n//# sourceMappingURL=../../../src/services/essentials/dom-utils.js.map"]},"metadata":{},"sourceType":"module"}