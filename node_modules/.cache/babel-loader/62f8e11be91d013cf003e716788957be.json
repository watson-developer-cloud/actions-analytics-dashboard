{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { Component } from '../component';\nimport { Tools } from '../../tools';\nimport { DOMUtils } from '../../services';\nimport { Events, TruncationTypes } from '../../interfaces';\nimport * as Configuration from '../../configuration'; // Carbon position service\n\nimport Position, { PLACEMENTS } from '@carbon/utils-position'; // import the settings for the css prefix\n\nimport settings from 'carbon-components/es/globals/js/settings'; // D3 Imports\n\nimport { select, mouse } from 'd3-selection';\nimport { format } from 'date-fns';\n\nvar Tooltip =\n/** @class */\nfunction (_super) {\n  __extends(Tooltip, _super);\n\n  function Tooltip(model, services, configs) {\n    var _this = _super.call(this, model, services, configs) || this;\n\n    _this.type = 'tooltip'; // flag for checking whether tooltip event listener is added or not\n\n    _this.isEventListenerAdded = false;\n    _this.positionService = new Position();\n\n    _this.handleShowTooltip = function (e) {\n      var data = e.detail.data || e.detail.items;\n\n      var defaultHTML = _this.getTooltipHTML(e);\n\n      var tooltipTextContainer = DOMUtils.appendOrSelect(_this.tooltip, 'div.content-box'); // if there is a provided tooltip HTML function call it\n\n      if (Tools.getProperty(_this.getOptions(), 'tooltip', 'customHTML')) {\n        if (e.detail.content) {\n          var labelHTML = \"<div class=\\\"title-tooltip\\\"><p>\" + e.detail.content + \"</p></div>\";\n          tooltipTextContainer.html(labelHTML);\n        } else {\n          tooltipTextContainer.html(_this.model.getOptions().tooltip.customHTML(data, defaultHTML));\n        }\n      } else {\n        // Use default tooltip\n        tooltipTextContainer.html(defaultHTML);\n      } // Position the tooltip\n\n\n      _this.positionTooltip(e); // Fade in\n\n\n      _this.tooltip.classed('hidden', false).attr('aria-hidden', false);\n    };\n\n    _this.handleHideTooltip = function () {\n      _this.tooltip.classed('hidden', true).attr('aria-hidden', true);\n    };\n\n    _this.init();\n\n    return _this;\n  }\n\n  Tooltip.prototype.addTooltipEventListener = function () {\n    var _this = this; // listen to move-tooltip Custom Events to move the tooltip\n\n\n    this.services.events.addEventListener(Events.Tooltip.MOVE, function (e) {\n      _this.positionTooltip(e);\n    }); // listen to show-tooltip Custom Events to render the tooltip\n\n    this.services.events.addEventListener(Events.Tooltip.SHOW, this.handleShowTooltip); // listen to hide-tooltip Custom Events to hide the tooltip\n\n    this.services.events.addEventListener(Events.Tooltip.HIDE, this.handleHideTooltip); // listen to chart-mouseout event to hide the tooltip\n\n    this.services.events.addEventListener(Events.Chart.MOUSEOUT, this.handleHideTooltip);\n  };\n\n  Tooltip.prototype.removeTooltipEventListener = function () {\n    // remove move-tooltip Custom Events\n    this.services.events.removeEventListener(Events.Tooltip.MOVE, null); // remove show-tooltip Custom Events\n\n    this.services.events.removeEventListener(Events.Tooltip.SHOW, this.handleShowTooltip); // remove hide-tooltip Custom Events\n\n    this.services.events.removeEventListener(Events.Tooltip.HIDE, this.handleHideTooltip); // remove the listener on chart-mouseout\n\n    this.services.events.removeEventListener(Events.Chart.MOUSEOUT, this.handleHideTooltip);\n  };\n\n  Tooltip.prototype.getItems = function (e) {\n    if (e.detail.items) {\n      return e.detail.items;\n    }\n\n    return [];\n  };\n\n  Tooltip.prototype.formatItems = function (items) {\n    var _this = this;\n\n    var options = this.getOptions(); // get user provided custom values for truncation\n\n    var truncationType = Tools.getProperty(options, 'tooltip', 'truncation', 'type');\n    var truncationThreshold = Tools.getProperty(options, 'tooltip', 'truncation', 'threshold');\n    var truncationNumCharacter = Tools.getProperty(options, 'tooltip', 'truncation', 'numCharacter'); // truncate the label if it's too long\n    // only applies to discrete type\n\n    if (truncationType !== TruncationTypes.NONE) {\n      return items.map(function (item) {\n        // get width of the label icon if it exists\n        var labelIconSize = item.labelIcon ? 12 : 0;\n        item.value = item.value ? _this.valueFormatter(item.value, item.label) : item.value;\n\n        if (item.label && item.label.length + labelIconSize > truncationThreshold) {\n          item.label = Tools.truncateLabel(item.label, truncationType, truncationNumCharacter);\n        }\n\n        if (item.value && item.value.length > truncationThreshold) {\n          item.value = Tools.truncateLabel(item.value, truncationType, truncationNumCharacter);\n        }\n\n        return item;\n      });\n    }\n\n    return items;\n  };\n\n  Tooltip.prototype.getTooltipHTML = function (e) {\n    var defaultHTML;\n\n    if (e.detail.content) {\n      defaultHTML = \"<div class=\\\"title-tooltip\\\"><p>\" + e.detail.content + \"</p></div>\";\n    } else {\n      var items = this.getItems(e);\n      var formattedItems = this.formatItems(items);\n      defaultHTML = \"<ul class='multi-tooltip'>\" + formattedItems.map(function (item) {\n        return \"<li>\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\\"datapoint-tooltip \" + (item.bold ? 'bold' : '') + \"\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\" + (item.class ? \"<a class=\\\"tooltip-color \" + item.class + \"\\\"></a>\" : '') + \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\" + (item.color ? '<a style=\"background-color: ' + item.color + '\" class=\"tooltip-color\"></a>' : '') + \"\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"label\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<p>\" + (item.label || '') + \"</p>\\n\\t\\t\\t\\t\\t\\t\\t\\t\" + (item.labelIcon ? \"<span class=\\\"label-icon\\\"/>\" + item.labelIcon + \"</span>\" : '') + \"\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\" + (item.value === undefined || item.value === null ? '' : \"<p class=\\\"value\\\"/>\" + item.value + \"</p>\") + \"\\n\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t</li>\";\n      }).join('') + \"</ul>\";\n    }\n\n    return defaultHTML;\n  };\n\n  Tooltip.prototype.valueFormatter = function (value, label) {\n    var options = this.getOptions();\n    var valueFormatter = Tools.getProperty(options, 'tooltip', 'valueFormatter');\n\n    if (valueFormatter) {\n      return valueFormatter(value, label);\n    }\n\n    if (typeof value.getTime === 'function') {\n      return format(value, 'MMM d, yyyy');\n    }\n\n    return value.toLocaleString();\n  };\n\n  Tooltip.prototype.render = function () {\n    var options = this.getOptions();\n    var isTooltipEnabled = Tools.getProperty(options, 'tooltip', 'enabled');\n\n    if (isTooltipEnabled) {\n      // Grab the tooltip element\n      var holder = select(this.services.domUtils.getHolder());\n      var chartprefix = Tools.getProperty(options, 'style', 'prefix');\n      this.tooltip = DOMUtils.appendOrSelect(holder, \"div.\" + settings.prefix + \"--\" + chartprefix + \"--tooltip\");\n      this.tooltip.style('max-width', null);\n\n      if (!this.isEventListenerAdded) {\n        this.addTooltipEventListener();\n        this.isEventListenerAdded = true;\n      }\n\n      this.tooltip.classed('hidden', true);\n    } else if (!isTooltipEnabled && this.isEventListenerAdded) {\n      // remove tooltip eventListener\n      this.removeTooltipEventListener();\n      this.isEventListenerAdded = false;\n    }\n  };\n\n  Tooltip.prototype.positionTooltip = function (e) {\n    var holder = this.services.domUtils.getHolder();\n    var target = this.tooltip.node();\n    var options = this.getOptions();\n    var isTopZoomBarEnabled = Tools.getProperty(options, 'zoomBar', 'top', 'enabled');\n    var mouseRelativePos = Tools.getProperty(e, 'detail', 'mousePosition');\n\n    if (!mouseRelativePos) {\n      mouseRelativePos = mouse(holder);\n    } else {\n      var zoombarType = Tools.getProperty(options, 'zoomBar', 'top', 'type');\n      var zoombarHeight = Configuration.zoomBar.height[zoombarType]; // if the mouse position is from event (ruler)\n      // we need add zoom bar height\n\n      if (isTopZoomBarEnabled) {\n        mouseRelativePos[1] += zoombarHeight + Configuration.zoomBar.spacerHeight; // TODO - we need to add toolbar height when toolbar is available\n      }\n    }\n\n    var pos;\n    var holderWidth = holder.offsetWidth;\n    var holderHeight = holder.offsetHeight;\n    var bestPlacementOption;\n\n    if (mouseRelativePos[0] / holderWidth > 0.9) {\n      bestPlacementOption = PLACEMENTS.LEFT;\n    } else if (mouseRelativePos[0] / holderWidth < 0.1) {\n      bestPlacementOption = PLACEMENTS.RIGHT;\n    } else {\n      // Find out whether tooltip should be shown on the left or right side\n      bestPlacementOption = this.positionService.findBestPlacementAt({\n        left: mouseRelativePos[0],\n        top: mouseRelativePos[1]\n      }, target, [PLACEMENTS.RIGHT, PLACEMENTS.LEFT, PLACEMENTS.TOP, PLACEMENTS.BOTTOM], function () {\n        return {\n          width: holderWidth,\n          height: holderHeight\n        };\n      });\n    }\n\n    var horizontalOffset = Configuration.tooltips.horizontalOffset;\n\n    if (bestPlacementOption === PLACEMENTS.LEFT) {\n      horizontalOffset *= -1;\n    } // Get coordinates to where tooltip should be positioned\n\n\n    pos = this.positionService.findPositionAt({\n      left: mouseRelativePos[0] + horizontalOffset,\n      top: mouseRelativePos[1]\n    }, target, bestPlacementOption);\n    this.positionService.setElement(target, pos);\n  };\n\n  return Tooltip;\n}(Component);\n\nexport { Tooltip };","map":{"version":3,"sources":["/Users/zander/Documents/Development/ActionsLogging/Dashboard/node_modules/@carbon/charts/components/essentials/tooltip.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","Component","Tools","DOMUtils","Events","TruncationTypes","Configuration","Position","PLACEMENTS","settings","select","mouse","format","Tooltip","_super","model","services","configs","_this","call","type","isEventListenerAdded","positionService","handleShowTooltip","e","data","detail","items","defaultHTML","getTooltipHTML","tooltipTextContainer","appendOrSelect","tooltip","getProperty","getOptions","content","labelHTML","html","customHTML","positionTooltip","classed","attr","handleHideTooltip","init","addTooltipEventListener","events","addEventListener","MOVE","SHOW","HIDE","Chart","MOUSEOUT","removeTooltipEventListener","removeEventListener","getItems","formatItems","options","truncationType","truncationThreshold","truncationNumCharacter","NONE","map","item","labelIconSize","labelIcon","value","valueFormatter","label","length","truncateLabel","formattedItems","bold","class","color","undefined","join","getTime","toLocaleString","render","isTooltipEnabled","holder","domUtils","getHolder","chartprefix","prefix","style","target","node","isTopZoomBarEnabled","mouseRelativePos","zoombarType","zoombarHeight","zoomBar","height","spacerHeight","pos","holderWidth","offsetWidth","holderHeight","offsetHeight","bestPlacementOption","LEFT","RIGHT","findBestPlacementAt","left","top","TOP","BOTTOM","width","horizontalOffset","tooltips","findPositionAt","setElement"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Component } from '../component';\nimport { Tools } from '../../tools';\nimport { DOMUtils } from '../../services';\nimport { Events, TruncationTypes } from '../../interfaces';\nimport * as Configuration from '../../configuration';\n// Carbon position service\nimport Position, { PLACEMENTS } from '@carbon/utils-position';\n// import the settings for the css prefix\nimport settings from 'carbon-components/es/globals/js/settings';\n// D3 Imports\nimport { select, mouse } from 'd3-selection';\nimport { format } from 'date-fns';\nvar Tooltip = /** @class */ (function (_super) {\n    __extends(Tooltip, _super);\n    function Tooltip(model, services, configs) {\n        var _this = _super.call(this, model, services, configs) || this;\n        _this.type = 'tooltip';\n        // flag for checking whether tooltip event listener is added or not\n        _this.isEventListenerAdded = false;\n        _this.positionService = new Position();\n        _this.handleShowTooltip = function (e) {\n            var data = e.detail.data || e.detail.items;\n            var defaultHTML = _this.getTooltipHTML(e);\n            var tooltipTextContainer = DOMUtils.appendOrSelect(_this.tooltip, 'div.content-box');\n            // if there is a provided tooltip HTML function call it\n            if (Tools.getProperty(_this.getOptions(), 'tooltip', 'customHTML')) {\n                if (e.detail.content) {\n                    var labelHTML = \"<div class=\\\"title-tooltip\\\"><p>\" + e.detail.content + \"</p></div>\";\n                    tooltipTextContainer.html(labelHTML);\n                }\n                else {\n                    tooltipTextContainer.html(_this.model\n                        .getOptions()\n                        .tooltip.customHTML(data, defaultHTML));\n                }\n            }\n            else {\n                // Use default tooltip\n                tooltipTextContainer.html(defaultHTML);\n            }\n            // Position the tooltip\n            _this.positionTooltip(e);\n            // Fade in\n            _this.tooltip.classed('hidden', false).attr('aria-hidden', false);\n        };\n        _this.handleHideTooltip = function () {\n            _this.tooltip.classed('hidden', true).attr('aria-hidden', true);\n        };\n        _this.init();\n        return _this;\n    }\n    Tooltip.prototype.addTooltipEventListener = function () {\n        var _this = this;\n        // listen to move-tooltip Custom Events to move the tooltip\n        this.services.events.addEventListener(Events.Tooltip.MOVE, function (e) {\n            _this.positionTooltip(e);\n        });\n        // listen to show-tooltip Custom Events to render the tooltip\n        this.services.events.addEventListener(Events.Tooltip.SHOW, this.handleShowTooltip);\n        // listen to hide-tooltip Custom Events to hide the tooltip\n        this.services.events.addEventListener(Events.Tooltip.HIDE, this.handleHideTooltip);\n        // listen to chart-mouseout event to hide the tooltip\n        this.services.events.addEventListener(Events.Chart.MOUSEOUT, this.handleHideTooltip);\n    };\n    Tooltip.prototype.removeTooltipEventListener = function () {\n        // remove move-tooltip Custom Events\n        this.services.events.removeEventListener(Events.Tooltip.MOVE, null);\n        // remove show-tooltip Custom Events\n        this.services.events.removeEventListener(Events.Tooltip.SHOW, this.handleShowTooltip);\n        // remove hide-tooltip Custom Events\n        this.services.events.removeEventListener(Events.Tooltip.HIDE, this.handleHideTooltip);\n        // remove the listener on chart-mouseout\n        this.services.events.removeEventListener(Events.Chart.MOUSEOUT, this.handleHideTooltip);\n    };\n    Tooltip.prototype.getItems = function (e) {\n        if (e.detail.items) {\n            return e.detail.items;\n        }\n        return [];\n    };\n    Tooltip.prototype.formatItems = function (items) {\n        var _this = this;\n        var options = this.getOptions();\n        // get user provided custom values for truncation\n        var truncationType = Tools.getProperty(options, 'tooltip', 'truncation', 'type');\n        var truncationThreshold = Tools.getProperty(options, 'tooltip', 'truncation', 'threshold');\n        var truncationNumCharacter = Tools.getProperty(options, 'tooltip', 'truncation', 'numCharacter');\n        // truncate the label if it's too long\n        // only applies to discrete type\n        if (truncationType !== TruncationTypes.NONE) {\n            return items.map(function (item) {\n                // get width of the label icon if it exists\n                var labelIconSize = item.labelIcon ? 12 : 0;\n                item.value = item.value\n                    ? _this.valueFormatter(item.value, item.label)\n                    : item.value;\n                if (item.label &&\n                    item.label.length + labelIconSize > truncationThreshold) {\n                    item.label = Tools.truncateLabel(item.label, truncationType, truncationNumCharacter);\n                }\n                if (item.value && item.value.length > truncationThreshold) {\n                    item.value = Tools.truncateLabel(item.value, truncationType, truncationNumCharacter);\n                }\n                return item;\n            });\n        }\n        return items;\n    };\n    Tooltip.prototype.getTooltipHTML = function (e) {\n        var defaultHTML;\n        if (e.detail.content) {\n            defaultHTML = \"<div class=\\\"title-tooltip\\\"><p>\" + e.detail.content + \"</p></div>\";\n        }\n        else {\n            var items = this.getItems(e);\n            var formattedItems = this.formatItems(items);\n            defaultHTML =\n                \"<ul class='multi-tooltip'>\" +\n                    formattedItems\n                        .map(function (item) {\n                        return \"<li>\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\\"datapoint-tooltip \" + (item.bold ? 'bold' : '') + \"\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\" + (item.class ? \"<a class=\\\"tooltip-color \" + item.class + \"\\\"></a>\" : '') + \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\" + (item.color\n                            ? '<a style=\"background-color: ' +\n                                item.color +\n                                '\" class=\"tooltip-color\"></a>'\n                            : '') + \"\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\\"label\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<p>\" + (item.label || '') + \"</p>\\n\\t\\t\\t\\t\\t\\t\\t\\t\" + (item.labelIcon ? \"<span class=\\\"label-icon\\\"/>\" + item.labelIcon + \"</span>\" : '') + \"\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\" + (item.value === undefined ||\n                            item.value === null\n                            ? ''\n                            : \"<p class=\\\"value\\\"/>\" + item.value + \"</p>\") + \"\\n\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t</li>\";\n                    })\n                        .join('') +\n                    \"</ul>\";\n        }\n        return defaultHTML;\n    };\n    Tooltip.prototype.valueFormatter = function (value, label) {\n        var options = this.getOptions();\n        var valueFormatter = Tools.getProperty(options, 'tooltip', 'valueFormatter');\n        if (valueFormatter) {\n            return valueFormatter(value, label);\n        }\n        if (typeof value.getTime === 'function') {\n            return format(value, 'MMM d, yyyy');\n        }\n        return value.toLocaleString();\n    };\n    Tooltip.prototype.render = function () {\n        var options = this.getOptions();\n        var isTooltipEnabled = Tools.getProperty(options, 'tooltip', 'enabled');\n        if (isTooltipEnabled) {\n            // Grab the tooltip element\n            var holder = select(this.services.domUtils.getHolder());\n            var chartprefix = Tools.getProperty(options, 'style', 'prefix');\n            this.tooltip = DOMUtils.appendOrSelect(holder, \"div.\" + settings.prefix + \"--\" + chartprefix + \"--tooltip\");\n            this.tooltip.style('max-width', null);\n            if (!this.isEventListenerAdded) {\n                this.addTooltipEventListener();\n                this.isEventListenerAdded = true;\n            }\n            this.tooltip.classed('hidden', true);\n        }\n        else if (!isTooltipEnabled && this.isEventListenerAdded) {\n            // remove tooltip eventListener\n            this.removeTooltipEventListener();\n            this.isEventListenerAdded = false;\n        }\n    };\n    Tooltip.prototype.positionTooltip = function (e) {\n        var holder = this.services.domUtils.getHolder();\n        var target = this.tooltip.node();\n        var options = this.getOptions();\n        var isTopZoomBarEnabled = Tools.getProperty(options, 'zoomBar', 'top', 'enabled');\n        var mouseRelativePos = Tools.getProperty(e, 'detail', 'mousePosition');\n        if (!mouseRelativePos) {\n            mouseRelativePos = mouse(holder);\n        }\n        else {\n            var zoombarType = Tools.getProperty(options, 'zoomBar', 'top', 'type');\n            var zoombarHeight = Configuration.zoomBar.height[zoombarType];\n            // if the mouse position is from event (ruler)\n            // we need add zoom bar height\n            if (isTopZoomBarEnabled) {\n                mouseRelativePos[1] +=\n                    zoombarHeight + Configuration.zoomBar.spacerHeight;\n                // TODO - we need to add toolbar height when toolbar is available\n            }\n        }\n        var pos;\n        var holderWidth = holder.offsetWidth;\n        var holderHeight = holder.offsetHeight;\n        var bestPlacementOption;\n        if (mouseRelativePos[0] / holderWidth > 0.9) {\n            bestPlacementOption = PLACEMENTS.LEFT;\n        }\n        else if (mouseRelativePos[0] / holderWidth < 0.1) {\n            bestPlacementOption = PLACEMENTS.RIGHT;\n        }\n        else {\n            // Find out whether tooltip should be shown on the left or right side\n            bestPlacementOption = this.positionService.findBestPlacementAt({\n                left: mouseRelativePos[0],\n                top: mouseRelativePos[1],\n            }, target, [\n                PLACEMENTS.RIGHT,\n                PLACEMENTS.LEFT,\n                PLACEMENTS.TOP,\n                PLACEMENTS.BOTTOM,\n            ], function () { return ({\n                width: holderWidth,\n                height: holderHeight,\n            }); });\n        }\n        var horizontalOffset = Configuration.tooltips.horizontalOffset;\n        if (bestPlacementOption === PLACEMENTS.LEFT) {\n            horizontalOffset *= -1;\n        }\n        // Get coordinates to where tooltip should be positioned\n        pos = this.positionService.findPositionAt({\n            left: mouseRelativePos[0] + horizontalOffset,\n            top: mouseRelativePos[1],\n        }, target, bestPlacementOption);\n        this.positionService.setElement(target, pos);\n    };\n    return Tooltip;\n}(Component));\nexport { Tooltip };\n//# sourceMappingURL=../../../src/components/essentials/tooltip.js.map"]},"metadata":{},"sourceType":"module"}